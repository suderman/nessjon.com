// Generated by CoffeeScript 1.6.1
/*
                       (_)
    _ __   ___  ___ ___ _  ___  _ __    ___ ___  _ __ ___
   | '_ \ / _ \/ __/ __| |/ _ \| '_ \  / __/ _ \| '_ ` _ \
   | | | |  __/\__ \__ \ | (_) | | | || (_| (_) | | | | | |
   |_| |_|\___||___/___/ |\___/|_| |_(_)___\___/|_| |_| |_|
                      _/ |
                     |__/                               
                                                        ;-)
*/(function(){Modernizr.load({load:["scripts/lib/jquery.min.js","scripts/lib/underscore.min.js","scripts/lib/fastclick.min.js","scripts/lib/mousetrap.js","scripts/dev/fixie.min.js"],complete:function(){return jQuery(app.init())}});window.app={};app.init=function(){app.setup();app.secretSong();app.countdown();app.navigation();app.slideshow();return $("html").addClass("ready")};app.setup=function(){new FastClick(document.body);_.templateSettings={interpolate:/\#\{(.+?)\}/g};_.mixin({linkify:function(e){e=e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a target='_blank' href='$1'>$1</a>");e=e.replace(/(^|\s)@(\w+)/g,"$1<a target='_blank' href='http://www.twitter.com/$2'>@$2</a>");return e=e.replace(/(^|\s)#(\w+)/g,"$1<a target='_blank' href='http://search.twitter.com/search?q=%23$2'>#$2</a>")}});(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i))&&jQuery("html").addClass("iphone");return app.transitionEnd="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend"};app.navigation=function(){$("header[role=banner] a.menu").on("click",function(e){e.preventDefault();e.stopPropagation();return $("html").toggleClass("menu")});$(document).on("click","html.menu",function(e){if(!$(e.target).parents("nav[role=navigation]").length)return $("html").removeClass("menu")});$("nav[role=navigation] > ul > li > a").on("click",function(e){var t,n;e.preventDefault();t=$(this).next("nav");if(t.height()===0){t.closest("ul").find("> li > nav").height(0);t.height(t.find("ul:first").height());return t.hide().show()}$("html").removeClass("menu");n=$(this).attr("href");return $("html, body").animate({scrollTop:$(n).offset().top},500,function(){return window.location.hash=n})});return $(document).on("swipe",function(e){e.direction==="left"&&$("html").addClass("menu");if(e.direction==="right")return $("html").removeClass("menu")})};app.countdown=function(){return $(".countdown").each(function(){var e,t,n,r,i,s,o,u,a;e=$(this);t=e.attr("rel").split(" ")[0];u=e.attr("rel").split(" ")[1];a=parseInt(t.split("-")[0],10);o=parseInt(t.split("-")[1],10)-1;n=parseInt(t.split("-")[2],10);i=parseInt(u.split(":")[0],10);s=parseInt(u.split(":")[1],10);r=Date.UTC(a,o,n,i,s,0);app.updateCountdown(e,r);return setInterval(function(){return app.updateCountdown(e,r)},5e3)})};app.updateCountdown=function(e,t){var n,r,i,s,o,u,a,f;r=new Date;n=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds());s=(t-n)/864e5;i=parseInt(s,10);i<0&&(i=0);u=(s-i)*24;o=parseInt(u,10);o<0&&(o=0);f=(u-o)*60;a=parseInt(f,10);a<0&&(a=0);e.find("dd:nth-of-type(1) figure").text(i);e.find("dd:nth-of-type(2) figure").text(o);return e.find("dd:nth-of-type(3) figure").text(a)};app.secretSong=function(){return Mousetrap.bind("z o o",function(){return $("body").append("<embed src=files/secret.mp3 autostart=true loop=false width=2 height=0>")})};app.slideshow=function(){return $("div.hero").each(function(){var e,t,n=this;e=$(this);e.find("li:first").addClass("active");app.slideshow.advance=function(){var t,n;n=e.find("li:first");t=n.next("li");t.addClass("active");return n.addClass("previous").on(app.transitionEnd,function(){return n.off().detach().removeClass("active previous").appendTo(t.parent())})};t=setInterval(app.slideshow.advance,7e3);return $("header[role=banner] h1 a").on("click",function(e){e.preventDefault();return app.slideshow.advance()})})}}).call(this);