// Generated by CoffeeScript 1.6.1
/*
                       (_)
    _ __   ___  ___ ___ _  ___  _ __    ___ ___  _ __ ___
   | '_ \ / _ \/ __/ __| |/ _ \| '_ \  / __/ _ \| '_ ` _ \
   | | | |  __/\__ \__ \ | (_) | | | || (_| (_) | | | | | |
   |_| |_|\___||___/___/ |\___/|_| |_(_)___\___/|_| |_| |_|
                      _/ |
                     |__/

  Compiled from:
  http://nessjon.com/scripts/script.coffee
                                                      ;-)
*/(function(){yepnope({test:ie<=8,yep:"/scripts/lib/nwmatcher-selectivizr.js"});yepnope({test:ie<=7,yep:"/styles/lib/ie6.1.1.css"});yepnope({load:["/scripts/lib/jquery.min.js","/scripts/lib/underscore.min.js","/scripts/lib/fastclick.min.js","/scripts/lib/mousetrap.js","/scripts/lib/jquery.fitmaps.js"],complete:function(){return jQuery(app.init())}});window._gaq=[["_setAccount","UA-35747031-1"],["_trackPageview"],["_trackPageLoadTime"]];yepnope({load:"//www.google-analytics.com/ga.js"});window.app={};app.init=function(){app.setup();app.secretSong();app.countdown();app.navigation();app.slideshow();app.map();return $("html").addClass("ready")};app.setup=function(){new FastClick(document.body);_.templateSettings={interpolate:/\#\{(.+?)\}/g};_.mixin({linkify:function(e){e=e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a target='_blank' href='$1'>$1</a>");e=e.replace(/(^|\s)@(\w+)/g,"$1<a target='_blank' href='http://www.twitter.com/$2'>@$2</a>");return e=e.replace(/(^|\s)#(\w+)/g,"$1<a target='_blank' href='http://search.twitter.com/search?q=%23$2'>#$2</a>")}});return app.transitionEnd="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend"};app.navigation=function(){$("header[role=banner] a.menu").on("click",function(e){e.preventDefault();e.stopPropagation();return $("html").toggleClass("menu")});$(document).on("click","html.menu",function(e){if(!$(e.target).parents("nav[role=navigation]").length)return $("html").removeClass("menu")});$("nav[role=navigation] > ul > li > a").on("click",function(e){var t,n;e.preventDefault();t=$(this).next("nav");if(t.height()===0){t.closest("ul").find("> li > nav").height(0);t.height(t.find("ul:first").height());return t.hide().show()}$("html").removeClass("menu");n=$(this).attr("href");return $("html, body").animate({scrollTop:$(n).offset().top},500,function(){return window.location.hash=n})});return $(document).on("swipe",function(e){e.direction==="left"&&$("html").addClass("menu");if(e.direction==="right")return $("html").removeClass("menu")})};app.countdown=function(){return $(".countdown").each(function(){var e,t,n,r,i,s,o,u,a;e=$(this);t=e.attr("rel").split(" ")[0];u=e.attr("rel").split(" ")[1];a=parseInt(t.split("-")[0],10);o=parseInt(t.split("-")[1],10)-1;n=parseInt(t.split("-")[2],10);i=parseInt(u.split(":")[0],10);s=parseInt(u.split(":")[1],10);r=Date.UTC(a,o,n,i,s,0);app.updateCountdown(e,r);return setInterval(function(){return app.updateCountdown(e,r)},5e3)})};app.updateCountdown=function(e,t){var n,r,i,s,o,u,a,f;r=new Date;n=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds());s=(t-n)/864e5;i=parseInt(s,10);i<0&&(i=0);u=(s-i)*24;o=parseInt(u,10);o<0&&(o=0);f=(u-o)*60;a=parseInt(f,10);a<0&&(a=0);e.find("dd:nth-of-type(1) figure").text(i);e.find("dd:nth-of-type(2) figure").text(o);return e.find("dd:nth-of-type(3) figure").text(a)};app.secretSong=function(){app.foundSecretSong=!1;app.mp3=$("audio:first").get(0);app.mp3.load();$(document).keydown(function(){if(app.foundSecretSong)return app.mp3.paused?app.mp3.play():app.mp3.pause()});return Mousetrap.bind("z o o",function(){app.foundSecretSong=!0;return app.mp3.play()})};app.map=function(){return $("figure.map").each(function(){var e;e=$(this).closest("section").find(".col:first").height();return $(this).fitMaps({w:"100%",h:e-100+"px"})})};app.slideshow=function(){return $("div.hero").each(function(){var e,t,n=this;e=$(this);e.find("li:first").css({opacity:1});app.slideshow.advance=function(){var t,n;n=e.find("li:first");t=n.next("li");t.animate({opacity:1},1500);return n.animate({opacity:0},1500,function(){return n.off().detach().appendTo(t.parent())})};t=setInterval(app.slideshow.advance,7e3);return $("header[role=banner] h1 a").on("click",function(e){e.preventDefault();return app.slideshow.advance()})})}}).call(this);