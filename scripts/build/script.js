// Generated by CoffeeScript 1.4.0
(function() {

  Modernizr.load({
    load: ['scripts/lib/jquery.min.js', 'scripts/lib/underscore.min.js', 'scripts/lib/mousetrap.js'],
    complete: function() {
      return app.init();
    }
  });

  window._gaq = [["_setAccount", "UA-35747031-1"], ["_trackPageview"], ["_trackPageLoadTime"]];

  Modernizr.load({
    load: ("https:" === location.protocol ? "//ssl" : "//www") + ".google-analytics.com/ga.js"
  });

  window.app = {};

  app.init = function() {
    app.setup();
    app.doSomething(true);
    return app.secretSong();
  };

  app.setup = function() {
    _.templateSettings = {
      interpolate: /\#\{(.+?)\}/g
    };
    _.mixin({
      linkify: function(string) {
        string = string.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, "<a target='_blank' href='$1'>$1</a>");
        string = string.replace(/(^|\s)@(\w+)/g, "$1<a target='_blank' href='http://www.twitter.com/$2'>@$2</a>");
        return string = string.replace(/(^|\s)#(\w+)/g, "$1<a target='_blank' href='http://search.twitter.com/search?q=%23$2'>#$2</a>");
      }
    });
    if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i)) {
      return (jQuery('html')).addClass('iphone');
    }
  };

  app.doSomething = function(arg) {};

  app.secretSong = function() {
    return Mousetrap.bind("z o o", function() {
      return $("body").append("<embed src=files/secret.mp3 autostart=true loop=false width=2 height=0>");
    });
  };

}).call(this);
